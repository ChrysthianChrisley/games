var textdata=[];textdata[0]="Ready?",textdata[1]="Game Over",textdata[2]="Got Him!",textdata[3]="Level ",textdata[4]="Time: ",textdata[5]=" sec",textdata[6]="Destroyed car bonus: ",textdata[7]="Miles: ",textdata[8]="Spies Caught: ",textdata[9]="Cars Destroyed: ",textdata[10]="Rank: ",textdata[11]="Tap screen to play",textdata[12]="Go!";var ranks=["Rookie","Cadet","Officer","Seargent","Special Agent"];function rnd(e){return Math.floor(Math.random()*e)+1}function trim(e){return e.replace(/^\s+|\s+$/g,"")}function write(e){return;var t,n,r,i}var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,r=e[t].prop;this.versionSearchString=e[t].versionSearch||e[t].identity;if(n){if(n.indexOf(e[t].subString)!=-1)return e[t].identity}else if(r)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(t==-1)return;return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};function spritesheet(e){this.sheet=e,this.sheetname=e.sheetname,this.type=e.type,this.height=e.height,this.width=e.width,this.framewidth=e.framewidth,this.frameheight=e.frameheight,this.framedelay=e.framedelay,this.framesperdirection=e.framesperdirection,this.deathframe=e.deathframe,this.deathframecount=e.deathframecount,this.attackframe=e.attackframe,this.attackframecount=e.attackframecount,this.painframe=e.painframe,this.painframecount=e.painframecount,this.image=new Image,this.image.setAttribute("id",this.sheetname),this.image.src=e.src}function road(e,t,n,r,i,s,o){this.id=e,this.w=t,this.h=n,this.x=r,this.y=i,this.colour=s,this.direction=o,this.bump=!1,this.boost=!1}function sprite(e,t,n,r,i,s,o,u){this.id=e,this.nid=t,this.spritesheet=n,this.frame=0,this.startframe=0,this.framedelay=n.framedelay,this.framedelaymax=n.framedelay,this.x=r,this.y=i,this.oldx=r,this.oldy=i,this.basex=r,this.basey=i,this.targetx=-1,this.targety=-1,this.w=n.framewidth,this.h=n.frameheight,this.speed=s,this.basespeed=s,this.direction=o,this.lastdirection=o,this.offset=0,this.frame=0,this.row=0,this.visible=u>0?!0:!1,this.moveup=!1,this.movedown=!1,this.moveleft=!1,this.moveright=!1,this.angle=0,this.opacity=1,this.decay=0,this.dying=!1,this.spinning=0,this.dead=!1,this.inpain=!1,this.boosting=0,this.jumping=!1,this.nextthink=1,this.basenextthink=this.nextthink};var imglib=[{sheetname:"playersheet",type:"player",src:"library/playersheet.gif",width:144,height:48,framewidth:48,frameheight:48,framedelay:2,framesperdirection:2,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"choppersheet",type:"chopper",src:"library/choppersheet.png",width:128,height:64,framewidth:64,frameheight:64,framedelay:1,framesperdirection:2,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"carsheet",type:"car",src:"library/carsheet.gif",width:96,height:240,framewidth:48,frameheight:48,framedelay:2,framesperdirection:2,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"alertsheet",type:"alerter",src:"library/alert.gif",width:64,height:32,framewidth:32,frameheight:32,framedelay:4,framesperdirection:2,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"spycarsheet",type:"spycar",src:"library/spycar.gif",width:96,height:48,framewidth:48,frameheight:48,framedelay:2,framesperdirection:2,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"playershadow",type:"playershadow",src:"library/playershadow.png",width:96,height:48,framewidth:48,frameheight:48,framedelay:1,framesperdirection:1,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"numberssheet",type:"numbers",src:"library/numbers.png",width:240,height:48,framewidth:24,frameheight:48,framedelay:0,framesperdirection:0,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"explosionsheet",type:"explosion",src:"library/explosion.png",width:288,height:48,framewidth:48,frameheight:48,framedelay:4,framesperdirection:5,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"playermissilesheet",type:"playermissile",src:"library/playermissile.png",width:8,height:32,framewidth:8,frameheight:16,framedelay:0,framesperdirection:1,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"entitysheet",type:"entity",src:"library/entities.png",width:64,height:224,framewidth:32,frameheight:32,framedelay:4,framesperdirection:2,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"tilesheet",type:"tile",src:"library/tilesheet.gif",width:48,height:48,framewidth:48,frameheight:48,framedelay:4,framesperdirection:1,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0},{sheetname:"markersheet",type:"marker",src:"library/marker.png",width:128,height:32,framewidth:32,frameheight:32,framedelay:1,framesperdirection:3,deathframe:0,deathframecount:0,attackframe:0,attackframecount:0,painframe:0,painframecount:0}];var gamedata={imageFiles:["library/titlescreen.png","library/entities.png","library/characterset.gif","library/alert.gif","library/explosion.png","library/gamebackdrop.png","library/gameover.png","library/hiscore.png","library/level.png","library/levelcomplete.png","library/marker.png","library/numbers.png","library/spygot.png","library/playermissile.png","library/playersheet.gif","library/playpause.png","library/pregame.png","library/notportrait.png","library/playershadow.png","library/volumecontrols.png","library/choppersheet.png","library/spycar.gif","library/carsheet.gif","library/splash.png"],audioFiles:[{name:"titlemusic",path:"sfx/music.mp3",volume:20,repeat:!0},{name:"bonusitem",path:"sfx/bonusitem.mp3",volume:100,repeat:!1}]};function createSprites(){for(var e=0;e<imglib.length;e++)m.spritesheets[imglib[e].sheetname]=new spritesheet(imglib[e]);g.titlescreen=new Image,g.titlescreen.src=g.imageData[0].src,g.gamebackdrops=[],g.gamebackdrops[0]=new Image,g.gamebackdrops[0].src="library/gamebackdrop.png",g.gamebackdrops[1]=new Image,g.gamebackdrops[1].src="library/blank.gif",g.gameover=new Image,g.gameover.src="library/gameover.png",g.levelicon=new Image,g.levelicon.src="library/level.png",g.hiscore=new Image,g.hiscore.src="library/hiscore.png",g.spygot=new Image,g.spygot.src="library/spygot.png",g.levelcomplete=new Image,g.levelcomplete.src="library/levelcomplete.png",g.playpause=new Image,g.playpause.src="library/playpause.png",g.pregame=new Image,g.pregame.src="library/pregame.png",g.notportrait=new Image,g.notportrait.src="library/notportrait.png",g.volumecontrol=new Image,g.volumecontrol.src="library/volumecontrols.png",g.splash=new Image,g.splash.src="library/splash.png",m.player=new sprite("player","player",m.spritesheets.playersheet,0,0,8,4,1),m.spycar=new sprite("spycar","spycar",m.spritesheets.spycarsheet,0,0,8,4,1),m.chopper=new sprite("chopper","chopper",m.spritesheets.choppersheet,0,0,8,4,0),m.car=new sprite("car","car",m.spritesheets.carsheet,0,0,8,4,0),m.alerter=new sprite("alert","alert",m.spritesheets.alertsheet,0,0,8,4,0),m.playershadow=new sprite("playershadow","playershadow",m.spritesheets.playershadow,0,0,8,4,1),m.numbers=new sprite("numbers","numbers",m.spritesheets.numberssheet,0,0,0,0,1);for(var e=0;e<8;e++)m.explosion[e]=new sprite("explosion"+e,"explosion",m.spritesheets.explosionsheet,0,0,2,0,0);for(var e=0;e<6;e++)m.entity[e]=new sprite("entity"+e,"entity",m.spritesheets.entitysheet,0,0,0,0,0);for(var e=0;e<8;e++)m.tile[e]=new sprite("tile"+e,"tile",m.spritesheets.tilesheet,0,0,0,0,0);for(var e=0;e<8;e++)m.playermissile[e]=new sprite("playermissile"+e,"playermissile",m.spritesheets.playermissilesheet,0,0,8,0,0);for(var e=0;e<g.canvasheight/48+1;e++)m.road[e]=new road("road"+e,0,g.roadheight,24,g.roadheight*-1,"#eee",4);initTouch(),initHiScore(),setSplash(),g.ticker=setTimeout("loop()",0)}function rnd(e){return Math.floor(Math.random()*e)+1}function preCache(){for(var e=0;e<gamedata.imageFiles.length;e++)g.imageData[e]=new Image,g.imageData[e].src=gamedata.imageFiles[e],g.imageData[e].onload=check;soundManager.ontimeout(function(){write("SoundManager unable to initialise.")})}function check(){g.checkCount++,write("Loaded "+g.checkCount+" of "+g.checkSum);var e=Math.round(g.checkCount/g.checkSum*100),t=Math.round(g.canvaswidth*(e/100));g.ctx.clearRect(140,150,32,16),g.ctx.fillStyle="rgb(16,16,16)",g.ctx.fillRect(0,200,g.canvaswidth,16),g.ctx.fillStyle="rgb(80,80,80)",g.ctx.fillRect(0,200,t,16),g.checkCount>=g.checkSum&&createSprites()}function rnd(e){return Math.floor(Math.random()*e)+1}function init(){try{g.canvas=document.querySelector("canvas"),g.ctx=g.canvas.getContext("2d"),g.canvas.setAttribute("class","canvas"),g.ori=0,setCanvasDimensions(),g.nextthink=0,g.banad=document.getElementById("banad"),g.nextthink=0,window.scrollTo(0,0),g.pausemode=0,g.audiomode=1,preCache()}catch(e){write(e.message)}}function setCanvasDimensions(e){g.canvaspadding=32,g.displaypadding=0,typeof window.orientation!="undefined"&&(g.ori=window.orientation),g.canvaswidth=320,g.canvasheight=480,g.canvas.width=g.canvaswidth,g.canvas.height=g.canvasheight,window.scrollTo(0,0)}function initTouch(){checkForTouch()?document.body.addEventListener?(document.body.addEventListener("touchmove",touchMove,!1),document.body.addEventListener("touchstart",touchStart,!1)):(window.addEventListener("touchmove",touchMove,!1),window.addEventListener("touchstart",touchStart,!1)):(window.addEventListener("mousemove",mouseMove,!1),window.addEventListener("mouseup",mouseUp,!1),write("No touch capability."))}function initHiScore(){typeof localStorage.key=="function"&&(localStorage.getItem("spychase-hiscore")!=null?m.player.hiscore=localStorage.getItem("spychase-hiscore"):m.player.hiscore=0)}function sfx(e){return}function handleAudio(){g.audiomode<1?soundManager.pauseAll():soundManager.resumeAll()}function checkForTouch(){var e=document.createElement("div");return e.setAttribute("ontouchmove","return;"),typeof e.ontouchmove=="function"?!0:!1}function touch(e){g.mode=="title"&&setGame(),g.mode=="pregame"&&g.resetting<50&&(g.mode="game");var t=m.player,n=e.pageX-(g.canvas.offsetParent?g.canvas.parentNode.offsetLeft:0)-t.w/2,r=e.pageY-(g.canvas.offsetParent?g.canvas.parentNode.offsetTop:0)-t.h/2;n<64&&r<64&&g.pausemode++,g.pausemode>1&&(g.pausemode=0),n<128&&n>64&&r<64&&g.audiomode++,g.audiomode>1&&(g.audiomode=0),g.pausemode<1&&m.player.spinning<1&&g.mode=="game"&&!m.player.dying&&(t.targetx=n),g.speedup=!1,g.slowdown=!1}function touchStart(e){touch(e.touches[0]),window.scrollTo(0,1),e.preventDefault()}function touchMove(e){touch(e.touches[0])}function mouseMove(e){g.mode!="title"&&touch(e)}function mouseUp(e){touch(e)}function setSplash(){g.mode="splash",g.resetting=100}function setTitle(){g.mode="title",g.stage=0,setStage(),g.roadspeedmax=16,g.roadspeed=g.roadspeedmax,g.roadwidth=180,g.roadx=g.canvaswidth/2-g.roadwidth/2,setRoad()}function setGame(){g.mode="pregame",m.player.score=0,m.player.targetscore=0,m.player.lives=3,g.level=1,g.displaylevel=1,g.resetting=120,g.roadspeedmax=16,g.targetroadspeed=g.roadspeedmax,g.highestpossibleroadspeed=28,g.roadwidth=180,g.roadx=g.canvaswidth/2-g.roadwidth/2,g.stage=0,g.miles=0,g.spymiles=0,g.spiescaught=0,g.totalmiles=0,g.carsdestroyed=0,g.stagecarsdestroyed=0,g.bonuspoints=0,g.roadcolourtoggle=0,m.alerter.visible=!1,setLevel(),setRoad(null),playerStart()}function setLevel(){wipe(!0),g.resetting=120,g.roadnextthinkmax=20,g.roadnextthink=g.roadnextthinkmax,g.roaddir=rnd(10)<5?0:1,setSpyDistance(),setStage()}function setRoad(e){try{if(e!=null&&typeof e=="object")if(g.mode=="pregame"||g.mode=="title")e.x=g.roadx,spawnTileChance(e),e.colour=stages[g.stage].road;else{g.roadnextthink--,g.roadnextthink<0&&(g.roadnextthink=g.roadnextthinkmax,g.roadnextthinkmax=rnd(30),g.roaddir=rnd(10)<5?0:1,g.roadscaling=rnd(100)<g.level?rnd(10)<3?3:4:4+rnd(4),g.targetwidth=g.canvaswidth*g.roadscaling*.1);var t=g.targetwidth;g.roadwidth>t&&(g.roadwidth-=1,g.roadwidth<t&&(g.roadwidth=t)),g.roadwidth<t&&(g.roadwidth+=1,g.roadwidth>t&&(g.roadwidth=t)),g.roadx+=g.roaddir>0?2:-2,g.roadx>g.canvaswidth-16-g.roadwidth&&(g.roadx=g.canvaswidth-16-g.roadwidth),g.roadx<16&&(g.roadx=16),e.boost=rnd(800)<10-g.level/2?!0:!1,e.x=g.roadx,e.w=g.roadwidth,g.roadcolourtoggle++,g.roadcolourtoggle>1&&(g.roadcolourtoggle=0),e.colour=stages[g.stage].road,spawnEntityChance(e),spawnTileChance(e),spawnCarChance(e),spawnChopperChance(e)}else for(var n=0;n<m.road.length;n++)m.road[n].x=g.roadx,m.road[n].y=-g.roadheight+n*g.roadheight,m.road[n].w=g.roadwidth,m.road[n].h=g.roadheight,m.road[n].colour=stages[g.stage].road,m.road[n].direction=4,m.road[n].bump=!1}catch(r){write(r.message)}}function setLandscape(){g.oldmode=g.mode,g.mode="landscape"}function playerStart(){m.player.x=g.canvaswidth/2-m.player.w/2,m.player.y=g.canvasheight-256,m.player.basey=g.canvasheight-128,m.playershadow.x=m.player.x,m.playershadow.y=m.player.y+4,m.playershadow.targetx=m.player.x,m.playershadow.targety=g.canvasheight-188,m.playershadow.row=0,m.playershadow.startframe=0,m.player.targetx=m.player.x,m.player.targety=g.canvasheight-128,m.player.health=100,m.player.stars=0,m.player.magicpower=0,m.player.row=0,m.player.startframe=0,m.player.damage=0,m.player.boosting=0,m.player.jumping=!0,m.player.offroad=!1,m.player.spritesheet.framesperdirection=2,m.player.dying=!1,m.player.missilerow=0,m.player.missilecooldownmax=10,m.player.missilecooldown=m.player.missilecooldownmax,m.player.missilecount=0,g.clockstart=new Date}function wipe(e){for(var t=0;t<m.monster.length;t++)m.monster[t].visible=!1;if(e)for(var t=0;t<m.entity.length;t++)m.entity[t].visible=!1,m.entity[t].x=-32,m.entity[t].y=-32}function playerDeath(){if(m.player.dying)return;m.player.dying=!0,g.resetting=100}function drawPlayer(e){var t=m.playershadow;if(!e.visible)return;e.magicpower>0?(e.magicpower--,e.row=1):e.row=0;try{isNaN(e.attacking)&&(e.attacking=0),e.attacking>0?(e.attacking--,e.frame=e.spritesheet.attackframe):(g.ctx.save(),e.spinning>0?(e.angle+=32,e.angle>360&&(e.angle=0),g.ctx.translate(e.x+e.w/2,e.y+e.h/2),g.ctx.rotate(e.angle*(Math.PI/180)),g.ctx.drawImage(t.spritesheet.image,t.frame*t.spritesheet.framewidth,0,t.w,t.h,-t.w/2,e.jumping?stages[g.stage].type=="night"?-t.h/2-40:-t.h/2+(24-e.speed):stages[g.stage].type=="night"?-t.h/2-40:-t.h/2+4,t.w,t.h),g.ctx.drawImage(e.spritesheet.image,e.frame*e.spritesheet.framewidth,0,e.w,e.h,-e.w/2,-e.h/2,e.w,e.h),e.spinning--,e.spinning<1&&(g.roadspeed=g.roadspeedmax)):(e.dying&&spawnExplosion(e,0,1),isNaN(e.frame)&&(e.frame=e.startframe),e.framedelay--,e.framedelay<0&&(e.framedelay=e.framedelaymax,e.frame++,e.frame>=e.startframe+e.spritesheet.framesperdirection&&(e.frame=e.startframe),e.magicpower>0&&e.magicpower<50&&(e.row++,e.row>1&&(e.row=0))),e.inpain&&(e.frame=e.spritesheet.painframe,e.inpain=!1),e.angle=g.mode=="caughtspy"?e.angle+=.5:e.targetx>e.x+e.w?20:e.targetx<e.x?340:0,g.mode=="caughtspy"&&e.angle>20&&(e.angle=20),g.ctx.translate(e.x+e.w/2,e.y+e.h/2),g.ctx.rotate(e.angle*(Math.PI/180)),t.frame=stages[g.stage].type=="night"?1:0,g.pc=isNaN(g.pc)?0:g.pc,e.row=!(g.pc<.25||m.spycar.y==m.player.y)||g.mode!="game"&&g.mode!="caughtspy"?0:1,g.ctx.drawImage(t.spritesheet.image,t.frame*t.spritesheet.framewidth,0,t.w,t.h,-t.w/2,e.jumping?stages[g.stage].type=="night"?-t.h/2-40:-t.h/2+(24-e.speed):stages[g.stage].type=="night"?-t.h/2-40:-t.h/2+4,t.w,t.h),g.ctx.drawImage(e.spritesheet.image,e.frame*e.spritesheet.framewidth,e.row*e.spritesheet.frameheight,e.w,e.h,-e.w/2,-e.h/2,e.w,e.h)),g.ctx.restore())}catch(n){write(e.frame+" - "+n.message)}}function draw(e){if(!e.visible)return;try{isNaN(e.attacking)&&(e.attacking=0),e.attacking>0?(e.attacking--,e.frame=e.spritesheet.attackframe):(isNaN(e.frame)&&(e.frame=e.startframe),e.framedelay--,e.framedelay<0&&(e.framedelay=e.framedelaymax,e.frame++,e.frame>=e.startframe+e.spritesheet.framesperdirection&&(e.spritesheet.type=="explosion"?remove(e):e.frame=e.startframe)),e.inpain&&(e.frame=e.spritesheet.painframe,e.inpain=!1)),g.ctx.save(),g.ctx.drawImage(e.spritesheet.image,e.frame*e.spritesheet.framewidth,e.row*e.spritesheet.frameheight,e.w,e.h,e.x,e.y,e.w,e.h),g.ctx.restore()}catch(t){write(e.row+" - "+e.spritesheet.type+", "+e.frame+" - "+t.message)}}function moveRoad(e){if(g.pausemode>0)return;switch(e.direction){case 4:e.y+=g.roadspeed;break;case 0:e.y-=g.roadspeed}e.y>g.canvasheight&&(e.y=g.roadheight*-1+(e.y-g.canvasheight)+1,setRoad(e))}function drawRoad(e){if(e.boost){var t=g.ctx.createLinearGradient(e.x,e.y,e.x,e.y+e.h);t.addColorStop(0,"#ff0000"),t.addColorStop(.5,"#0000ff"),t.addColorStop(.75,"#ffff00"),g.ctx.fillStyle=t}else g.ctx.fillStyle=e.colour;g.ctx.fillRect(e.x,e.y,e.w,e.h)}function moveToTarget(e){if(!e.visible||e.dead||g.pausemode>0)return;e.oldx=e.x,e.oldy=e.y;if(e.targetx<0&&e.targety<0)switch(e.direction){case 0:e.y-=e.speed;break;case 1:e.y-=e.speed/1.5,e.x+=e.speed/1.5;break;case 2:e.x+=e.speed;break;case 3:e.y+=e.speed/1.5,e.x+=e.speed/1.5;break;case 4:e.y+=e.speed;break;case 5:e.y+=e.speed/1.5,e.x-=e.speed/1.5;break;case 6:e.x-=e.speed;break;case 7:e.y-=e.speed/1.5,e.x-=e.speed/1.5}else e.jumping?(e.y>=e.targety&&(e.bounced?(e.speed=e.basespeed,e.jumping=!1):(e.bounced=!0,e.y=e.y-8,e.speed=-8)),e.dying>0&&(e.targetx>e.x&&(e.x+=e.speed),e.targetx<e.x&&(e.x-=e.speed),e.targety<e.y&&(e.y-=e.speed),e.targety>e.y&&(e.y+=e.speed),e.y<0&&remove(e)),e.bounced&&(e.speed+=2),e.y<e.targety&&(e.y+=e.speed)):(e.targetx>e.x+e.w/2&&(e.x+=e.speed),e.targetx<e.x+e.w/2&&(e.x-=e.speed),e.targety<e.y&&(e.y-=e.speed),e.targety>e.y&&(e.y+=e.speed),e.offroad&&g.mode!="caughtspy"&&!e.dying&&(e.x+=rnd(10)<5?rnd(4):rnd(4)*-1,e.spritesheet.type=="player"&&(e.damage++,e.damage>100&&playerDeath())),e.spritesheet.type=="player"&&(m.playershadow.x=e.x,m.playershadow.targetx=e.x,m.playershadow.y=e.y+4));e.dying<1&&(e.x<g.canvaspadding&&(e.x=g.canvaspadding),e.x+e.w>g.canvaswidth-g.canvaspadding&&(e.x=g.canvaswidth-g.canvaspadding-e.w),e.y<g.canvaspadding&&(e.y=g.canvaspadding),e.y+e.h>g.canvasheight-g.canvaspadding&&(e.y=g.canvasheight-g.canvaspadding-e.h))}function move(e){if(!e.visible||g.pausemode>0)return;switch(e.direction){case 0:e.y-=e.speed;break;case 1:e.y-=e.speed/1.5,e.x+=e.speed/1.5;break;case 2:e.x+=e.speed;break;case 3:e.y+=e.speed/1.5,e.x+=e.speed/1.5;break;case 4:e.y+=e.speed;break;case 5:e.y+=e.speed/1.5,e.x-=e.speed/1.5;break;case 6:e.x-=e.speed;break;case 7:e.y-=e.speed/1.5,e.x-=e.speed/1.5}e.direction==0&&e.y+e.h<0&&remove(e),e.direction==4&&e.y>g.canvasheight&&remove(e)}function throwStars(e,t){for(var n=0;n<m.player.stars;n++)spawnEntityChance(e,t)}function playerCarCollision(e){if(!e.visible||e.dying||m.player.dead||g.pausemode>0||e.boosting>0)return;var t=e.x,n=e.y,r=e.w,i=e.h,s=m.player.x,o=m.player.y,u=m.player.w,a=m.player.h,f=!1,l=!1,c=!1,h=!1;s<=t+r&&o<=n+i&&s>=t&&o>=n&&(f=!0),s+u>=t&&o>=n&&s+u<=t+r&&o<=n+i&&(l=!0),s<=t+r&&o+a>=n&&s>=t&&o+a<=n+i&&(c=!0),s+u>=t&&s+u<=t+r&&o+a>=n&&o+a<=n+i&&(h=!0);if(f==1||l==1||c==1||h==1)bump(e,m.player,f,l,c,h),e.playerbumped=!0,m.player.damage+=5,m.player.damage>100&&playerDeath()}function bump(e,t,n,r,i,s){n?e.y+e.h<t.y?(e.speed+=16,e.bumped=!0):(e.speed+=16,e.bumped=!0,e.x-=e.w):r?e.y+e.h<t.y?(e.speed+=16,e.bumped=!0):(e.speed+=16,e.bumped=!0,e.x+=e.w):i?(e.speed+=16,e.bumped=!0,e.x-=e.w):s&&(e.speed+=16,e.bumped=!0,e.x+=e.w)}function entityCollision(e,t){if(!e.visible||t.dead||t.dying>0||e.dying>0||g.pausemode>0)return;var n=e.x,r=e.y,i=e.w,s=e.h,o=t.x,u=t.y,a=t.w,f=t.h,l=!1,c=!1,h=!1,p=!1;n<=o+a&&r<=u+f&&n>=o&&r>=u&&(l=!0),n+i>=o&&r>=u&&n+i<=o+a&&r<=u+f&&(c=!0),n<=o+a&&r+s>=u&&n>=o&&r+s<=u+f&&(h=!0),n+i>=o&&n+i<=o+a&&r+s>=u&&r+s<=u+f&&(p=!0);if(l==1||c==1||h==1||p==1)switch(e.row){case 0:triggerJump(t);break;case 1:case 2:triggerSpin(t);break;case 3:t.spritesheet.type=="player"&&(t.damage-=10,t.damage<0&&(t.damage=0)),t.targetscore+=10,remove(e);break;case 4:g.roadspeedmax+=1,g.roadspeedmax>g.highestpossibleroadspeed&&(g.roadspeedmax=g.highestpossibleroadspeed),t.targetscore+=10,remove(e);break;case 5:t.missilerow=1,t.missilecooldownmax=25,t.missilecount=10,t.targetscore+=20,remove(e);break;case 6:t.missilerow=0,t.missilecooldownmax=10,t.missilecount=100,t.targetscore+=20,remove(e)}}function playerMissileCollision(e,t){if(!e.visible||!t.visible||t.dying>0||g.pausemode>0||t.spritesheet.type=="chopper"&&t.y>64)return;var n=e.x,r=e.y,i=e.w,s=e.h,o=t.x,u=t.y,a=t.w,f=t.h,l=!1,c=!1,h=!1,p=!1;n<=o+a&&r<=u+f&&n>=o&&r>=u&&(l=!0),n+i>=o&&r>=u&&n+i<=o+a&&r<=u+f&&(c=!0),n<=o+a&&r+s>=u&&n>=o&&r+s<=u+f&&(h=!0),n+i>=o&&n+i<=o+a&&r+s>=u&&r+s<=u+f&&(p=!0);if(l==1||c==1||h==1||p==1){switch(e.row){case 0:t.damage-=(e.row+1)*5;break;case 1:t.damage-=(e.row+1)*10}t.y-=t.spritesheet.type=="car"?16:4,t.playerbumped=!0,remove(e)}}function triggerSpin(e){if(e.spinning>0||e.dying)return;e.spinning=20,e.damage+=10}function triggerJump(e){if(e.jumping||e.spinning>0||e.dying)return;e.jumping=!0,e.y=e.basey-64,e.bounced=!1,e.targety=e.basey}function triggerBoost(e){if(e.spinning>0||e.dying)return;e.boosting=40}function roadCollision(e,t){if(e.y+e.h<t.y||e.y>t.y+t.h||t.dying||t.jumping)return;e.bump&&t.spritesheet.type=="player"&&triggerJump(t),e.boost&&t.boosting<1&&t.spritesheet.type=="player"&&triggerBoost(t),t.x+8<e.x||t.x+(t.w-8)>e.x+e.w?(t.offroad=!0,t.spritesheet.type=="player"&&(g.offroad=!0)):t.offroad=!1}function writeText(e,t,n,r){var i=t,s={};s.w=10,s.h=16;var o=new String(e);g.ctx.save(),g.ctx.font="normal "+r+"px sans-serif",g.ctx.shadowOffsetX=2,g.ctx.shadowOffsetY=2,g.ctx.shadowBlur=2,g.ctx.shadowColor="rgba(0, 0, 0, 0.9)",g.ctx.textAlign="left",g.ctx.fillStyle="#ffffff",g.ctx.fillText(o,t,n+8),g.ctx.restore()}function loop(){try{clearTimeout(g.ticker),g.ctx.save(),g.ctx.clearRect(0,0,g.canvaswidth,g.canvasheight);switch(g.mode){case"splash":g.ctx.drawImage(g.splash,0,0),g.resetting--,g.resetting<0&&setTitle();break;case"title":for(var e=0;e<m.road.length;e++)moveRoad(m.road[e]),drawRoad(m.road[e]);for(var e=0;e<m.tile.length;e++)m.tile[e].speed=g.roadspeed,move(m.tile[e]),draw(m.tile[e]);hiScore(),g.ctx.drawImage(g.titlescreen,g.canvaswidth/2-160,0),writeText(textdata[11],64,260,22);break;case"pregame":for(var e=0;e<m.road.length;e++)moveRoad(m.road[e]),drawRoad(m.road[e]);for(var e=0;e<m.tile.length;e++)m.tile[e].speed=g.roadspeed,move(m.tile[e]),draw(m.tile[e]);drawPlayer(m.player),moveToTarget(m.player),g.resetting--,g.resetting<1?(g.mode="game",g.resetting=120,g.go=1):g.go=0,writeText(textdata[0],124,200,20);break;case"game":g.nextthink>0&&g.nextthink--,g.offroad=!1;for(var e=0;e<m.road.length;e++)moveRoad(m.road[e]),drawRoad(m.road[e]),roadCollision(m.road[e],m.player),roadCollision(m.road[e],m.car);g.resetting>0&&g.go>0&&(writeText(textdata[12],124,200,20),g.resetting--),g.resetting<1&&(g.go=0);if(m.player.dying){g.resetting--;if(g.resetting<1){g.mode="gameover",g.resetting=150;for(var e=0;e<m.explosion.length;e++)remove(m.explosion[e])}g.roadspeedmax-=8,g.roadspeedmax<0&&(g.roadspeedmax=0),g.targetroadspeed=g.roadspeedmax}else m.player.spinning>0?(g.targetroadspeed-=.5,g.targetroadspeed<4&&(g.targetroadspeed=4)):m.player.jumping?g.targetroadspeed=g.roadspeedmax/2:m.player.boosting>0?(g.targetroadspeed=g.roadspeedmax+m.player.boosting,m.player.boosting--):g.offroad?g.targetroadspeed=g.roadspeedmax-4:g.speedup?(g.targetroadspeed+=1,g.targetroadspeed>g.roadspeedmax&&(g.targetroadspeed=g.roadspeedmax)):g.slowdown?(g.targetroadspeed-=1,g.targetroadspeed<16&&(g.targetroadspeed=16)):g.targetroadspeed=g.roadspeedmax;for(var e=0;e<m.entity.length;e++)m.entity[e].speed=g.roadspeed,move(m.entity[e]),draw(m.entity[e]),entityCollision(m.entity[e],m.player);for(var e=0;e<m.tile.length;e++)m.tile[e].speed=g.roadspeed,m.tile[e].row=g.stage,move(m.tile[e]),draw(m.tile[e]);drawPlayer(m.player),moveToTarget(m.player),moveSpyCar(),draw(m.spycar),moveCar(m.car),draw(m.car),moveChopper(m.chopper),playerCarCollision(m.car),m.player.missilecooldown--,m.player.missilecooldown<1&&(m.player.missilecooldown=m.player.missilecooldownmax,m.player.missilecount>0&&(m.player.missilecount--,spawnPlayerMissile(m.player.x+m.player.w/2-2,m.player.y-8,m.player.missilerow)));for(var e=0;e<m.playermissile.length;e++)move(m.playermissile[e]),draw(m.playermissile[e]),playerMissileCollision(m.playermissile[e],m.car),playerMissileCollision(m.playermissile[e],m.chopper);for(var e=0;e<m.explosion.length;e++)move(m.explosion[e]),draw(m.explosion[e]);draw(m.chopper),updateScore(),g.pausemode<1&&!m.player.dying&&(g.miles+=g.roadspeed/g.roadspeedmax,g.spymiles+=g.roadspeed/g.roadspeedmax,g.totalmiles+=g.roadspeed/g.roadspeedmax,g.miles>800&&setStage()),drawPlayerDamage(),drawRadar(),draw(m.alerter);break;case"caughtspy":g.pausemode<1&&(g.resetting--,g.resetting<1&&(setSpyDistance(),g.mode="game",g.roadspeedmax=16,g.targetroadspeed=g.roadspeedmax,remove(m.car))),g.targetroadspeed-=1,g.targetroadspeed<0&&(g.targetroadspeed=0);for(var e=0;e<m.road.length;e++)moveRoad(m.road[e]),drawRoad(m.road[e]),roadCollision(m.road[e],m.player);for(var e=0;e<m.entity.length;e++)m.entity[e].speed=g.roadspeed,move(m.entity[e]),draw(m.entity[e]),entityCollision(m.entity[e],m.player);for(var e=0;e<m.tile.length;e++)m.tile[e].speed=g.roadspeed,move(m.tile[e]),draw(m.tile[e]);drawPlayer(m.player),moveToTarget(m.player),draw(m.spycar),moveSpyCar(),moveCar(m.car),draw(m.car),moveChopper(m.chopper),draw(m.chopper),updateScore(),m.player.damage>0&&m.player.damage--,drawPlayerDamage(),writeText(textdata[2],100,200,32),writeText(textdata[3]+(g.displaylevel-1),100,256,16),writeText(textdata[4]+Math.round(g.spytime/1e3)+textdata[5],100,284,16),writeText(textdata[6],100,308,16),writeText(g.stagecarsdestroyed+" x 100 = "+g.stagecarsdestroyed*100,100,322,16);break;case"endlevel":for(var e=0;e<m.spark.length;e++)move(m.spark[e]),draw(m.spark[e]);g.resetting--,g.resetting<1&&setLevel(),g.ctx.drawImage(g.levelcomplete,24,200);break;case"landscape":break;case"levelup":g.ctx.drawImage(g.levelicon,90,200),writeLevel(),g.resetting--,g.resetting<1&&(playerStart(),g.mode="game");break;case"gameover":writeText(textdata[1],20,260,32),writeText(textdata[7]+Math.round(g.totalmiles/100),20,340,16),writeText(textdata[8]+g.spiescaught,20,280,16),writeText(textdata[9]+Math.round(g.carsdestroyed),20,300,16);var e=0;g.spiescaught>5&&(e=1),g.spiescaught>10&&(e=2),g.spiescaught>20&&(e=3),g.spiescaught>40&&(e=4),writeText(textdata[10]+ranks[e],20,320,16),g.resetting--,g.resetting<1&&setTitle(),updateScore()}g.mode!="title"&&g.mode!="splash"&&g.ctx.drawImage(g.playpause,g.pausemode*32,0,32,32,8,8,32,32),g.ori!=0&&(g.ctx.drawImage(g.notportrait,0,64),g.pausemode=1),isNaN(g.framedelay)&&(g.framedelay=30),g.ticker=setTimeout("loop()",g.framedelay),g.ctx.restore()}catch(t){write("*"+t.message)}}function setStage(){g.miles=0,g.stage++,g.stage>=stages.length&&(g.stage=0),g.canvas.style.background=stages[g.stage].colour}function caughtSpy(){g.mode="caughtspy",g.resetting=100,g.level++,g.level>20&&(g.level=20),g.displaylevel++,g.spiescaught++,m.player.boosting=0,m.player.spinning=0,m.player.jumping=!1;var e=new Date;g.spytime=e-g.clockstart,g.clockstart=new Date,m.player.score+=g.stagecarsdestroyed*100}function moveSpyCar(){if(g.pausemode>0)return;if(g.mode=="caughtspy"){if(g.roadspeed>0){var e=m.player.x+m.player.w-4;m.spycar.x-=.5,m.spycar.x<e&&(m.spycar.x=e);var t=m.player.y+40;m.spycar.y+=2,m.spycar.y>t&&(m.spycar.y=t)}}else m.spycar.x=m.player.x+m.player.w+rnd(8),m.spycar.distance+=m.spycar.speed-g.roadspeed,m.spycar.y=m.player.y-m.spycar.distance;g.roadspeed<g.targetroadspeed?(g.roadspeed++,g.roadspeed>g.targetroadspeed&&(g.roadspeed=g.targetroadspeed)):(g.roadspeed--,g.roadspeed<g.targetroadspeed&&(g.roadspeed=g.targetroadspeed)),writeText(Math.round(g.roadspeed*5)+"MPH",230,24,18)}function moveCar(e){if(g.pausemode>0||!e.visible)return;e.bumped&&(e.speed--,e.speed<e.basespeed&&(e.bumped=!1)),isNaN(e.nextthink)&&(e.nextthink=10),e.nextthink--,e.nextthink<1&&(e.direction=rnd(10)<5?2:6,e.nextthink=6,e.slidespeed=.1*rnd(10)),e.x+=e.direction==2?e.slidespeed:e.slidespeed*-1,e.offroad&&(e.x+=rnd(10)<5?rnd(4):rnd(4)*-1,e.damage-=25),e.damage<1&&(remove(e),spawnExplosion(e,0,1),m.player.targetscore+=50,e.playerbumped&&(g.carsdestroyed++,g.stagecarsdestroyed++)),e.y+=g.roadspeed-e.speed,m.alerter.x=e.x,e.y>0&&remove(m.alerter);if(e.y>g.canvasheight||e.x+e.w<0||e.x>g.canvaswidth)remove(e),e.bumped=!1}function moveChopper(e){if(g.pausemode>0||!e.visible)return;if(g.mode=="game")e.y>64?e.y-=e.speed:e.y<64?e.y+=e.speed:e.missilesleft>0&&(e.nextthink--,e.nextthink<1&&(e.nextthink=100,spawnExplosionXY(e.x+e.w/2,e.y+e.h/2,4,4),spawnEntity(e.x+e.w/2,e.y+e.h/2,1),e.missilesleft--));else if(g.mode=="caughtspy"||m.player.dying)e.y+=8;e.missilesleft<1&&(e.y+=8),e.x<m.player.x&&(e.x+=e.speed),e.x>m.player.x&&(e.x-=e.speed),e.y>g.canvasheight&&remove(e),e.damage<25?e.spritesheet.framesperdirection=3:e.spritesheet.framesperdirection=2,e.damage<1&&(remove(e),spawnExplosion(e,0,1),m.player.targetscore+=100)}function setSpyDistance(){g.spymiles=0,m.spycar.totaldistance=4e3+g.level*100,m.spycar.distance=m.spycar.totaldistance,m.spycar.speed=16+g.level/2,m.spycar.speed>g.highestpossibleroadspeed&&(m.spycar.speed=g.highestpossibleroadspeed),g.stagecarsdestroyed=0}function drawRadar(){if(m.player.dying)return;g.ctx.fillStyle="rgba(0,255,0,0.6)",g.ctx.fillRect(0,68,g.canvaswidth,16),m.player.y<=m.spycar.y+m.spycar.h&&caughtSpy(),g.pc=m.spycar.distance/m.spycar.totaldistance;var e=g.canvaswidth*g.pc;g.pc>1&&(e=g.canvaswidth-20),g.ctx.fillStyle="rgb(255,255,255)",g.ctx.fillRect(16,74,4,4),g.ctx.fillStyle="rgb(0,0,0)",g.ctx.fillRect(e+16,74,4,4)}function drawPlayerDamage(){if(m.player.dying)return;var e=g.canvaswidth*(m.player.damage/100);e>g.canvaswidth-100?(g.ctx.fillStyle="rgba("+rnd(255)+","+rnd(255)+",0,0.6)",m.player.spritesheet.framesperdirection=3):(g.ctx.fillStyle="rgba(192,0,0,0.6)",m.player.spritesheet.framesperdirection=2),g.ctx.fillRect(0,48,e,16)}function testFPS(){try{isNaN(g.fps)&&(g.fps=0);if(g.fps)var e=new Date,t=Math.round(1e3/(e-g.fps));var n=new String(t);g.fps=new Date,isNaN(g.testy)&&(g.testy=0),isNaN(g.ave)&&(g.ave=0),g.testy<20&&(g.testy++,g.ave+=t,g.testy>=10&&g.ave>1e3&&(g.framedelay=42))}catch(r){write(r.message)}}function spawnExplosion(e,t,n){for(var r=0;r<m.explosion.length;r++)if(!m.explosion[r].visible){var i=m.explosion[r];i.visible=!0,i.direction=t,i.x=e.x,i.y=e.y,i.speed=n,i.frame=0;break}}function spawnExplosionXY(e,t,n,r){for(var i=0;i<m.explosion.length;i++)if(!m.explosion[i].visible){var s=m.explosion[i];s.visible=!0,s.direction=n,s.x=e,s.y=t,s.speed=r,s.frame=0;break}}function spawnChopperChance(e){if(m.chopper.visible)return;var t=0,n=0;rnd(1e3)<g.level&&g.pausemode<1&&(t=g.canvaswidth/2,n=g.canvasheight-2,spawnChopper(t,n))}function spawnChopper(e,t){var n=m.chopper;n.visible=!0,n.x=e,n.y=t,n.speed=1,n.basespeed=n.speed,n.dying=0,n.nextthink=0,n.damage=100,n.missilesleft=5,write("Chopper spawned at "+e+", "+t)}function spawnCarChance(e){var t=0,n=0;if(rnd(100)<5&&g.pausemode<1){t=e.x+e.w/2-24,n=-256;var r=parseInt(m.spritesheets.carsheet.height)/parseInt(m.spritesheets.carsheet.frameheight),i=rnd(r)-1;spawnCar(t,n,i)}}function spawnCar(e,t,n){if(m.car.visible)return;var r=m.car;r.visible=!0,r.x=e,r.y=t,r.direction=4,r.speed=16+rnd(4),r.speed<m.player.speed+4&&(r.speed=m.player.speed+4),r.basespeed=r.speed,r.dying=0,r.row=n,r.nextthink=0,m.alerter.visible=!0,m.alerter.y=0,r.offroad=!1,r.damage=100,r.playerbumped=!1}function spawnEntityChance(e){var t=0,n=0;if(rnd(100)<10&&g.pausemode<1){t=e.x+32+rnd(g.roadwidth-64),n=0;var r=parseInt(m.spritesheets.entitysheet.height)/parseInt(m.spritesheets.entitysheet.frameheight),i=rnd(100)<g.level?rnd(3)-1:2+rnd(r-3);g.level<5&&i==5&&rnd(100)>5&&(i=4),spawnEntity(t,n,i)}}function spawnEntity(e,t,n){for(var r=0;r<m.entity.length;r++)if(!m.entity[r].visible){var i=m.entity[r];i.visible=!0,i.x=e,i.y=t,i.direction=4,i.speed=g.roadspeed,i.dying=0,i.row=n;break}}function spawnTileChance(e){var t=0,n=0;if(rnd(10)<6&&g.pausemode<1){var r=g.roadx,i=g.roadx+g.roadwidth;t=rnd(10)<5?rnd(r)-48:i+rnd(g.canvaswidth-i),n=0;var s=parseInt(m.spritesheets.tilesheet.height)/parseInt(m.spritesheets.tilesheet.frameheight),o=rnd(10)<5?0:1;spawnTile(t,n,o)}}function spawnTile(e,t,n){for(var r=0;r<m.tile.length;r++)if(!m.tile[r].visible){var i=m.tile[r];i.visible=!0,i.x=e,i.y=t,i.direction=4,i.speed=g.roadspeed,i.dying=0,i.row=n;break}}function spawnPlayerMissile(e,t,n){if(m.player.dying)return;for(var r=0;r<m.playermissile.length;r++)if(!m.playermissile[r].visible){var i=m.playermissile[r];i.visible=!0,i.x=e,i.y=t,i.direction=0,i.speed=16,i.dying=0,i.row=n;break}}function writeString(e,t,n){var r=m.spritesheets.numberssheet;for(var i=0;i<e.length;i++){t+=r.framewidth;var s=e.substr(i,1);g.ctx.drawImage(r.image,s*r.framewidth,0,r.framewidth,r.frameheight,t,n,r.framewidth,r.frameheight)}}function writeLevel(){var e=new String,t=new String(g.level),n=t.length,r=new String;for(var i=0;i<t.length;i++)r+=t.substring(i,i+1);writeString(r,190,200)}function hiScore(){try{var e=new String,t=new String(m.player.hiscore),n=t.length,r=new String;for(var i=0;i<5-n;i++)r+="0";for(var s=0;s<t.length;s++)r+=""+t.substring(s,s+1);writeString(r,80,0)}catch(o){write(o.message)}}function updateScore(){try{m.player.score+=1,m.player.score>m.player.targetscore&&(m.player.score=m.player.targetscore),m.player.score>m.player.hiscore&&(m.player.hiscore=Math.round(m.player.score),localStorage.setItem("spychase-hiscore",m.player.hiscore)),m.player.score>99999&&(m.player.score=99999);var e=new String,t=new String(m.player.score),n=t.length,r=new String;for(var i=0;i<5-n;i++)r+="0";for(var s=0;s<t.length;s++)r+=""+t.substring(s,s+1);writeString(r,70,0)}catch(o){write(o.message)}}function remove(e){e.visible=!1}function scanInput(e){window.event?keypress=e.keyCode:e.which&&(keypress=e.which);switch(keypress){case 16:break;case 18:break;case 32:g.mode=="title"&&setGame();break;case 38:break;case 40:break;case 39:break;case 37:break;case 67:g.console.style.display=g.console.style.display=="none"?"block":"none";break;case 80:g.pausemode++,g.pausemode>1&&(g.pausemode=0);break;case 83:g.audiomode++,g.audiomode>1&&(g.audiomode=0),handleAudio();break;case 17:case 90:g.mode=="title"&&setGame()}}function stopMove(e){window.event?keyup=e.keyCode:e.which&&(keyup=e.which);var t=0;keyup>=48&&keyup<=57&&(t=(48-keyup)*-1);switch(keyup){case 16:break;case 18:break;case 32:break;case 38:break;case 40:break;case 39:break;case 37:break;case 67:break;case 83:break;case 17:case 90:}}var g={};g.characterset=new Image,g.characterset.src="library/characterset.gif",g.roadheight=48,g.go=0;var m={spritesheets:[],player:null,spycar:null,chopper:null,car:null,playershadow:null,monster:[],numbers:null,explosion:[],playermissile:[],spark:[],entity:[],tile:[],road:[],alerter:null},stages=[{colour:"#000000",road:"#333",type:"night",terrain:"road"},{colour:"#13af28",road:"#666",type:"day",terrain:"road"},{colour:"#efefef",road:"#ccc",type:"day",terrain:"ice"},{colour:"#dfb113",road:"#e5c75f",type:"day",terrain:"sand"},{colour:"#013860",road:"#004a80",type:"night",terrain:"road"},{colour:"#bf0000",road:"#ca612e",type:"day",terrain:"hot"}],gameaudio=[];g.checkSum=gamedata.imageFiles.length,g.checkCount=0,g.imageData=[],g.audioData=[],g.loadingImage=new Image,g.loadingImage.src="library/loading.gif",window.onorientationchange=function(e){setCanvasDimensions(e)};